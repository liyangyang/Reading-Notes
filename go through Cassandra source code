Just go through Cassandra source code.
